<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div>
    <button onclick="store.dispatch({type: 'minus', n:2})">-</button>
    <span id="countDisplay">10</span>
    <button onclick="store.dispatch({type:'plus', n:2})">+</button>
</div>
<script type="text/javascript">
    const countDisplay = document.querySelector('#countDisplay');
    const countState = {
        count:5
    }

    // const minus = (n)=>{
    //     countState.count -= n;
    //     renderCount(countState);
    // }


    const changeState = (state, action) => {
        if(!state){
            return countState;
        }
        switch(action.type){
            case 'minus':
                return {
                    ...state,
                    count: state.count - action.n
                };

            case 'plus':
                return {
                    ...state,
                    count: state.count + action.n
                };
            default:
                return {
                    ...state
                }
        }
    }



    const createStore = (reducer) => {
         let state = null;
        const getState = () => state;
        const listeners = [];
        const subscribe = (listener) =>   listeners.push(listener);

        const dispatch = (action) => {
                state = reducer(state, action),
                listeners.forEach(listener => listener())
        }
        dispatch({});
        return {
            getState,
            dispatch,
            subscribe
        }

    }
    const store = createStore(changeState);

    const renderCount = () => {
        countDisplay.innerHTML = store.getState().count;
    }


renderCount()
    store.subscribe(renderCount);

</script>
</body>
</html>